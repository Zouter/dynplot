---
title: "Plotting a toy datasets using dynplot"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    fig_width: 5
    fig_height: 4 
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
library(dplyr)
library(dyntoy)
library(dynplot)
library(dynutils)
library(dynwrap)
```

Load in a toy dataset
```{r}
task <- toy_tasks %>% filter(trajectory_type == "bifurcation") %>% extract_row_to_list(1) %>% root_trajectory()
```

## Plotting the topology and cellular positions

If the topology is very simple (or should be represented in one dimension)
```{r onedim}
plot_onedim(task)
```

If the topology is a tree
```{r dendro}
plot_dendro(task)
```

If the topology is more complex
```{r graph}
plot_graph(task)

```

```{r}
plot_topology(task)
```

```{r}
plot_dimred(task)
```

## Plotting a grouping or clustering
```{r}
grouping_assignment <- task$prior_information$grouping_assignment
```

```{r grouping}
plot_onedim(task, grouping_assignment=grouping_assignment)
plot_dendro(task, grouping_assignment=grouping_assignment)
plot_graph(task, grouping_assignment=grouping_assignment)
plot_dimred(task, grouping_assignment=grouping_assignment)
```

## Plotting expression of one feature
```{r}
feature_oi <- first(colnames(task$counts))
```

```{r expression}
plot_onedim(task, feature_oi = feature_oi)
plot_dendro(task, feature_oi = feature_oi)
plot_graph(task, feature_oi = feature_oi)
plot_dimred(task, feature_oi = feature_oi)
```

## Plotting expression of a lot of features

```{r heatmap}
plot_heatmap(task)
```
```{r line}
# plot_features(task)
```



## Comparing trajectories
```{r}
pseudotime <- task$counts %>% prcomp() %>% {.$x[, 1]}
prediction <- dynwrap::wrap_data("dummy_prediction", task$cell_ids) %>%
  dynwrap::add_linear_trajectory_to_wrapper(pseudotime)

plot_strip_onedim(task, prediction)
```

