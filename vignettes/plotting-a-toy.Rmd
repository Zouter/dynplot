---
title: "Plotting a toy datasets using dynplot"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    fig_width: 5
    fig_height: 4 
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
library(dplyr)
library(dyntoy)
library(dynplot)
library(dynutils)
library(dynwrap)
```

Load in a toy dataset
```{r}
traj <- toy_tasks %>% filter(trajectory_type == "bifurcation") %>% extract_row_to_list(1) %>% root_trajectory()
```

## Plotting the topology and cellular positions

If the topology is very simple (or should be represented in one dimension)
```{r onedim}
plot_onedim(traj)
```

If the topology is a tree
```{r dendro}
plot_dendro(traj)
```

If the topology is more complex
```{r graph}
plot_graph(traj)

```

```{r}
plot_topology(traj)
```

```{r}
plot_dimred(traj)
```

## Plotting a grouping or clustering
```{r}
grouping_assignment <- traj$prior_information$grouping_assignment
```

```{r grouping}
plot_onedim(traj, grouping_assignment=grouping_assignment)
plot_dendro(traj, grouping_assignment=grouping_assignment)
plot_graph(traj, grouping_assignment=grouping_assignment)
plot_dimred(traj, grouping_assignment=grouping_assignment)
```

## Plotting expression of one feature
```{r}
feature_oi <- first(colnames(traj$counts))
```

```{r expression}
plot_onedim(traj, feature_oi = feature_oi)
plot_dendro(traj, feature_oi = feature_oi)
plot_graph(traj, feature_oi = feature_oi)
plot_dimred(traj, feature_oi = feature_oi)
```

## Plotting expression of a lot of features

```{r heatmap}
plot_heatmap(traj)
```
```{r line}
# plot_features(traj)
```



## Comparing trajectories
```{r}
pseudotime <- traj$counts %>% prcomp() %>% {.$x[, 1]}
prediction <- dynwrap::wrap_data("dummy_prediction", traj$cell_ids) %>%
  dynwrap::add_linear_trajectory(pseudotime)

plot_linearised_comparison(traj, prediction)
```

