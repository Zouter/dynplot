---
title: "Plotting a toy datasets using dynplot"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    fig_width: 5
    fig_height: 4 
vignette: >
  %\VignetteIndexEntry{generate_file_from_container(x)}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
library(dplyr)
library(dyntoy)
library(dynplot)
library(dynutils)
library(dynwrap)

set.seed(3)
```

Load in a toy dataset
```{r}
traj <- dyntoy::generate_dataset(model = "bifurcating", num_cells = 300) %>% add_root()
```

## Plotting the topology and cellular positions

If the topology is very simple (or should be represented in one dimension)
```{r onedim}
plot_onedim(traj)
```

If the topology is a tree
```{r dendro}
plot_dendro(traj)
```

If the topology is more complex
```{r graph}
plot_graph(traj)
```

```{r}
plot_topology(traj, layout = "circle")
```

```{r}
plot_dimred(traj)
```

## Plotting a grouping or clustering
```{r}
grouping <- traj$prior_information$groups_id
```

```{r grouping}
plot_onedim(traj, grouping = grouping)
plot_dendro(traj, grouping = grouping)
plot_graph(traj, grouping = grouping)
plot_dimred(traj, grouping = grouping)
```

## Plotting expression of one feature
```{r}
feature_oi <- first(colnames(traj$counts))
```

```{r expression}
plot_onedim(traj, feature_oi = feature_oi)
plot_dendro(traj, feature_oi = feature_oi)
plot_graph(traj, feature_oi = feature_oi)
plot_dimred(traj, feature_oi = feature_oi)
```

## Plotting expression of a lot of features

```{r heatmap}
plot_heatmap(traj)
```
```{r line}
plot_features(traj)
```

## Comparing trajectories
```{r}
pseudotime <- traj$counts %>% prcomp() %>% {.$x[, 1]}
prediction <- 
  dynwrap::wrap_data(id = "dummy_prediction", cell_ids = traj$cell_ids) %>%
  dynwrap::add_linear_trajectory(pseudotime)

plot_linearised_comparison(traj, prediction)
```

